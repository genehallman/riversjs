import Rivers from 'rivers/client';
import React from 'react';
import { connect } from 'react-redux';

import actions from './actions.jsx';

class App extends React.Component {
  componentWillMount() {
    this.props.getMessages();
  }

  render() {
    return (
      <div>
        <div id="header">Rivers</div>
        <div id="content">This site was auto generated by Rivers</div>
        <input ref={el => this.inputEl = el} />
        <button onClick={ev => this.props.newMessage(this.inputEl.value)}>Click Me</button>
        <div>
          {this.props.messages.map(m => <div key={m._id}>{m.text}<span onClick={ev => this.props.deleteMessage(m._id)}>-</span></div>)}
        </div>
      </div>
    )
  }
}
const mapStateToProps = (state, props) => {
  return {messages: (state.api.Messages || {}).message || []};
};
const mapDispatchToProps = (dispatch) => {
  return {
    getMessages: actions.Messages.getMessages,
    newMessage: actions.Messages.newMessage,
    deleteMessage: actions.Messages.deleteMessage
  };
};
export default Rivers(connect(mapStateToProps, mapDispatchToProps)(App));
